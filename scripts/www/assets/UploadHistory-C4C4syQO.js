import{_ as e}from"./index-BTSs0mnw.js";import{o as t,G as s,p as a,q as l,x as r,A as o,O as i,P as n,r as c,u as d}from"./vue-vendor-DsBWIAOi.js";const u={class:"upload-history-page fade-in"},v={class:"px-4 py-3 bg-white border-b border-gray-200"},p={class:"flex items-center justify-between"},x={class:"text-xs text-gray-500 mt-1"},m={class:"px-4 py-4"},f={key:0,class:"flex justify-center py-12"},g={key:1,class:"text-center py-12"},y={key:2,class:"space-y-3"},h={class:"flex items-start justify-between mb-3"},k={class:"flex-1"},b={class:"flex items-center space-x-2 mb-1"},w={class:"text-xs font-medium px-2 py-1 bg-primary-100 text-primary-700 rounded"},j={class:"text-xs text-gray-500"},B={class:"text-sm text-gray-900 line-clamp-2"},H={key:0,class:"text-xs text-gray-500 mt-1 flex items-center"},M=["onClick"],A={key:0,class:"mb-3"},C={class:"grid grid-cols-4 gap-2"},L=["src","alt"],S={key:1,class:"flex items-center justify-center w-full h-full"},V={class:"absolute bottom-0 left-0 right-0 bg-black/50 text-white text-xs p-1 truncate"},_={key:0,class:"relative aspect-square bg-gray-200 rounded-lg flex items-center justify-center"},z={class:"text-sm text-gray-600 font-medium"},I={key:1,class:"flex items-center justify-between text-xs text-gray-500"},q=e({__name:"UploadHistory",setup(e){const q=c([]),O=c(!1);function F(){confirm("确定要清空所有记录吗？")&&(q.value=[],localStorage.removeItem("uploads"),toast.success("已清空"))}function G(e){if(0===e)return"0 B";const t=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,t)).toFixed(1))+" "+["B","KB","MB","GB"][t]}return t(()=>{!function(){O.value=!0;try{const e=localStorage.getItem("uploads");e&&(q.value=JSON.parse(e))}catch(e){toast.error("加载失败")}finally{O.value=!1}}()}),(e,t)=>(s(),a("div",u,[l("div",v,[l("div",p,[l("div",null,[t[0]||(t[0]=l("h2",{class:"text-base font-bold text-gray-900"},"上传记录",-1)),l("p",x,"共 "+r(q.value.length)+" 条记录",1)]),q.value.length>0?(s(),a("button",{key:0,onClick:F,class:"px-3 py-1.5 bg-red-50 text-red-600 rounded-lg text-xs font-medium hover:bg-red-100 transition-colors"}," 清空全部 ")):o("",!0)])]),l("div",m,[O.value?(s(),a("div",f,[...t[1]||(t[1]=[l("div",{class:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600"},null,-1)])])):0===q.value.length?(s(),a("div",g,[...t[2]||(t[2]=[l("svg",{class:"w-16 h-16 text-gray-300 mx-auto mb-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[l("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.707.293H19a2 2 0 012-2z"})],-1),l("p",{class:"text-gray-500 text-sm"},"暂无上传记录",-1)])])):(s(),a("div",y,[(s(!0),a(i,null,n(q.value,e=>(s(),a("div",{key:e.id,class:"bg-white p-4 rounded-xl shadow-sm"},[l("div",h,[l("div",k,[l("div",b,[l("span",w,r(e.type),1),l("span",j,r(e.createTime),1)]),l("p",B,r(e.description),1),e.location?(s(),a("p",H,[t[3]||(t[3]=l("svg",{class:"w-3 h-3 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[l("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"})],-1)),d(" "+r(e.location),1)])):o("",!0)]),l("button",{onClick:t=>{return s=e.id,void(confirm("确定要删除这条记录吗？")&&(q.value=q.value.filter(e=>e.id!==s),localStorage.setItem("uploads",JSON.stringify(q.value)),toast.success("删除成功")));var s},class:"text-gray-400 hover:text-red-500 transition-colors p-1"},[...t[4]||(t[4]=[l("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[l("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 011-1h2a1 1 0 011 1v3a1 1 0 001 1v1a1 1 0 001 1 1 1 1 0 01-1 1v-3a1 1 0 011-1h2a1 1 0 011-1V4a1 1 0 011-1z"})],-1)])],8,M)]),e.files&&e.files.length>0?(s(),a("div",A,[l("div",C,[(s(!0),a(i,null,n(e.files.slice(0,4),(e,o)=>(s(),a("div",{key:o,class:"relative aspect-square bg-gray-100 rounded-lg overflow-hidden"},[e.type&&e.type.startsWith("image/")?(s(),a("img",{key:0,src:e.data,alt:e.name,class:"w-full h-full object-cover"},null,8,L)):(s(),a("div",S,[...t[5]||(t[5]=[l("svg",{class:"w-8 h-8 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[l("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 10l4.553-2.276A2 2 0 0121 8.618v4.764a2 2 0 01-2 2H5a2 2 0 01-2-2V8.618a2 2 0 012.447-2.276L12 10m0 0l4.553 2.276A2 2 0 0115 8.618v4.764a2 2 0 01-2 2H5a2 2 0 01-2-2V8.618a2 2 0 012.447-2.276L12 10m0 0l-4.553-2.276A2 2 0 0010.462 8.618v4.764a2 2 0 01-2 2H5.538a2 2 0 01-1.995-1.858L3 8m0 0l4.553 2.276A2 2 0 013.462 8.618v4.764a2 2 0 01-2 2H5.538a2 2 0 01-1.995-1.858L2 8m0 0l4.553 2.276A2 2 0 003.462 8.618v4.764a2 2 0 002 2H5.538a2 2 0 002-1.858L2 12"})],-1)])])),l("div",V,r(e.name),1)]))),128)),e.files.length>4?(s(),a("div",_,[l("span",z,"+"+r(e.files.length-4),1)])):o("",!0)])])):o("",!0),e.files?(s(),a("div",I,[l("span",null,r(e.files.length)+" 个文件",1),l("span",null,r(G(e.files.reduce((e,t)=>e+t.size,0))),1)])):o("",!0)]))),128))]))])]))}},[["__scopeId","data-v-4e77fb64"]]);export{q as default};
