import{m as e}from"./mock-LZpIbfPd.js";import{u as t,s as a,i as l,a as s,b as o,c as r,d as i,e as n,f as d}from"./echarts-bQr1n9_F.js";import{_ as u}from"./index-BTSs0mnw.js";import{o as m,G as c,p as v,q as x,x as y,O as p,P as g,A as b,Q as f,B as h,r as w,c as k,C as L}from"./vue-vendor-DsBWIAOi.js";const A={class:"monitoring-page fade-in"},S={class:"px-4 py-4 space-y-4"},P={key:0,class:"bg-gradient-to-r from-primary-600 to-primary-700 text-white p-4 rounded-xl shadow-md"},_={class:"text-sm mb-3 opacity-95"},j={class:"grid grid-cols-3 gap-3 text-center"},z={class:"text-2xl font-bold"},C={class:"text-2xl font-bold"},D={class:"text-2xl font-bold"},R={key:0,class:"mt-3 pt-3 border-t border-white/20"},T={class:"text-xs space-y-1 opacity-90"},W={class:"mr-1"},q={class:"bg-white p-4 rounded-xl shadow-sm"},B={key:0,class:"animate-pulse h-48 bg-gray-200 rounded-lg"},G={class:"bg-white p-4 rounded-xl shadow-sm"},I={key:0,class:"animate-pulse h-48 bg-gray-200 rounded-lg"},M={class:"bg-white p-4 rounded-xl shadow-sm"},O={key:0,class:"space-y-2"},Q={key:1,class:"overflow-x-auto"},E={class:"w-full text-sm"},F={class:"py-2 text-gray-900"},H={class:"text-right font-medium"},J={class:"text-center"},K=u({__name:"Monitoring",setup(u){t([l,s,o,r,i,n,d]);const K=w([]),N=w([]),U=w(null),V=w(!0);m(()=>{return t=null,a=null,l=function*(){try{const[t,a,l]=yield Promise.all([e.getRainfallData(),e.getWaterLevelData(),e.getAnalysisReport()]);K.value=t.data,N.value=a.data,U.value=l.data}catch(t){}finally{V.value=!1}},new Promise((e,s)=>{var o=e=>{try{i(l.next(e))}catch(t){s(t)}},r=e=>{try{i(l.throw(e))}catch(t){s(t)}},i=t=>t.done?e(t.value):Promise.resolve(t.value).then(o,r);i((l=l.apply(t,a)).next())});var t,a,l});const X=k(()=>({tooltip:{trigger:"axis",axisPointer:{type:"shadow"}},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},xAxis:{type:"category",data:K.value.map(e=>e.station),axisLabel:{interval:0,rotate:30,fontSize:10}},yAxis:{type:"value",name:"降雨量(mm)"},series:[{data:K.value.map(e=>({value:e.rainfall,itemStyle:{color:"暴雨"===e.level?"#dc2626":"大雨"===e.level?"#f97316":"中雨"===e.level?"#eab308":"#3b82f6"}})),type:"bar",barWidth:"60%"}]})),Y=k(()=>({tooltip:{trigger:"axis"},legend:{data:["当前水位","汛限水位"],bottom:0},grid:{left:"3%",right:"4%",bottom:"15%",containLabel:!0},xAxis:{type:"category",data:N.value.map(e=>e.name),axisLabel:{interval:0,rotate:30,fontSize:10}},yAxis:{type:"value",name:"水位(m)"},series:[{name:"当前水位",type:"line",data:N.value.map(e=>e.currentLevel),smooth:!0,itemStyle:{color:"#0ea5e9"}},{name:"汛限水位",type:"line",data:N.value.map(e=>e.warningLevel),smooth:!0,itemStyle:{color:"#ef4444"},lineStyle:{type:"dashed"}}]}));return(e,t)=>{var l;return c(),v("div",A,[x("div",S,[!V.value&&U.value?(c(),v("div",P,[t[4]||(t[4]=x("h2",{class:"text-base font-bold mb-3"},"汛情分析快报",-1)),x("p",_,y(U.value.summary),1),x("div",j,[x("div",null,[x("div",z,y(U.value.rainfallTotal),1),t[0]||(t[0]=x("div",{class:"text-xs opacity-80"},"平均降雨(mm)",-1))]),x("div",null,[x("div",C,y(U.value.affectedTowns),1),t[1]||(t[1]=x("div",{class:"text-xs opacity-80"},"影响乡镇",-1))]),x("div",null,[x("div",D,y(U.value.warningCount),1),t[2]||(t[2]=x("div",{class:"text-xs opacity-80"},"预警数量",-1))])]),(null==(l=U.value.suggestions)?void 0:l.length)?(c(),v("div",R,[t[3]||(t[3]=x("div",{class:"text-xs font-medium mb-2"},"处置建议:",-1)),x("ul",T,[(c(!0),v(p,null,g(U.value.suggestions,(e,t)=>(c(),v("li",{key:t,class:"flex items-start"},[x("span",W,y(t+1)+".",1),x("span",null,y(e),1)]))),128))])])):b("",!0)])):b("",!0),x("div",q,[t[5]||(t[5]=x("h2",{class:"text-sm font-bold text-gray-700 mb-3"},"各站点降雨量",-1)),V.value?(c(),v("div",B)):(c(),f(h(a),{key:1,class:"h-48",option:X.value,autoresize:""},null,8,["option"]))]),x("div",G,[t[6]||(t[6]=x("h2",{class:"text-sm font-bold text-gray-700 mb-3"},"水库水位趋势",-1)),V.value?(c(),v("div",I)):(c(),f(h(a),{key:1,class:"h-48",option:Y.value,autoresize:""},null,8,["option"]))]),x("div",M,[t[8]||(t[8]=x("h2",{class:"text-sm font-bold text-gray-700 mb-3"},"详细数据",-1)),V.value?(c(),v("div",O,[(c(),v(p,null,g(3,e=>x("div",{key:e,class:"animate-pulse h-12 bg-gray-200 rounded"})),64))])):(c(),v("div",Q,[x("table",E,[t[7]||(t[7]=x("thead",null,[x("tr",{class:"border-b border-gray-200"},[x("th",{class:"text-left py-2 text-gray-600 font-medium"},"站点/水库"),x("th",{class:"text-right py-2 text-gray-600 font-medium"},"数值"),x("th",{class:"text-center py-2 text-gray-600 font-medium"},"状态")])],-1)),x("tbody",null,[(c(!0),v(p,null,g([...K.value,...N.value],e=>(c(),v("tr",{key:e.id,class:"border-b border-gray-100"},[x("td",F,y(e.station||e.name),1),x("td",H,y(e.rainfall?e.rainfall+"mm":e.currentLevel+"m"),1),x("td",J,[x("span",{class:L({"px-2 py-1 rounded-full text-xs font-medium":!0,"bg-red-100 text-red-700":"暴雨"===e.level||"超汛限"===e.status,"bg-orange-100 text-orange-700":"大雨"===e.level,"bg-yellow-100 text-yellow-700":"中雨"===e.level,"bg-blue-100 text-blue-700":"小雨"===e.level,"bg-green-100 text-green-700":"正常"===e.status})},y(e.level||e.status),3)])]))),128))])])]))])])])}}},[["__scopeId","data-v-3f6f727b"]]);export{K as default};
